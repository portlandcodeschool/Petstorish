!!!5
%html
  %head
    %title Petstorish
    = stylesheet_link_tag    "application", :media => "all"
    = javascript_include_tag "application"
    = csrf_meta_tags
  %body
    ///////////////////////////////////////////////////////////
    //  SEARCH OVERLAY
    //////////////////////////////////////////////////////////
    #overlay-container
      :javascript
        var opacityTimer;
        var op = 0.0;
        var overlayDiv = $('#overlay-container');
        function fadeIn()
        {
          if(op> 1)
          {
            clearInterval(opacityTimer);
            overlayDiv.css({opacity: 1});
          }
          else
          {
            op = op + 0.05;
            overlayDiv.css({opacity: op});
            console.log(op)
          }

        }
        function fadeOut()
        {
          if(op < 0.1)
          {
            overlayDiv.css({display: 'none'});


            clearInterval(opacityTimer);
          }
          else
          {
            op = op - 0.05;
            overlayDiv.css({opacity: op});
            console.log(op)
          }

        }
        function hideOverlay(){
          clearInterval(opacityTimer);
          opacityTimer = setInterval(fadeOut,2);
        }
        function showOverlay(){

          console.log('showOverLay')
          clearInterval(opacityTimer)
          overlayDiv.show();
          $('.input-overlay').css({
            top:'30%',
            left:'50%',
            margin:'-'+($('.input-overlay').height() / 2)+
            'px 0 0 -'+($('.input-overlay').width() / 2)+'px'
            });

            opacityTimer = setInterval(fadeIn, 2);
        } 

      .overlay
      .input-overlay
        %h2 Search
        .search
          =form_tag("/s/", :method => "post") do

            = text_field_tag :query

            .checkboxen
              search in:
              %p
                = check_box_tag 'options[]', 'name', true
                Name

              %p
                = check_box_tag 'options[]', 'description', true
                Description

            .field
              price:
              .price
                minimum
                %p= select('price', 'minimum', (0..100).step(10))
              .price
                maximum
                %p= select('price', 'maximum', (0..100).step(10), :selected => 100)

              .button
                =submit_tag("search", :id => 'OverlaySearchButton')
            .close
              %a{:href=>'#', :onClick => "hideOverlay();"} close
      //////////////////////////////////////////////////////////
      //  HEADER 
      /////////////////////////////////////////////////////////

    .container
      .row
        .span12
          .header.clearfix
            .title
              =link_to 'Petstore...ish', products_path
            .right
              .cart
                %a{:href => '#'} Shopping Cart
              .search
                =form_tag("/s/", :method => "get") do
                  =text_field_tag(:query)
                .options
                  .link
                    %a{:href=>"#", :onClick => "showOverlay()"}Advanced Search
                  .button
                    =submit_tag("search", :id => 'SearchButton')
      .row
        .span2.sidebar
          %ul
            -Product.categories.each do |cat|
              %li
                =link_to cat, '/'+cat

        .span9.main
          - if flash[:notice]
            .notice
              %h2= flash[:notice]
          = yield

  :javascript
    $("#SearchButton").click(function(event) {
      event.preventDefault();
      window.location = "/s/"+$("#query").val();
      }); 


